<!DOCTYPE html>
<html>
<head>
    <meta charset='utf-8' />
    <meta http-equiv="X-UA-Compatible" content="chrome=1" />
    <meta name="description" content="Arrow : FE Test framework designed to promote TDD" />

    <link rel="stylesheet" type="text/css" media="screen" href="stylesheets/stylesheet.css">

    <title>Arrow In-Depth</title>
</head>
<body>

<!-- HEADER -->
<div id="header_wrap" class="outer">
    <header class="inner">
        <a id="forkme_banner" href="https://github.com/yahoo/arrow">View on GitHub</a>

        <h1 id="project_title">Arrow</h1>
        <h2 id="project_tagline">FE Test framework designed to promote TDD</h2>

        <section id="downloads">
            <a class="zip_download_link" href="https://github.com/yahoo/arrow/zipball/master">Download this project as a .zip file</a>
            <a class="tar_download_link" href="https://github.com/yahoo/arrow/tarball/master">Download this project as a tar.gz file</a>
        </section>
    </header>
</div>


<!-- MAIN CONTENT -->
<div id="main_content_wrap" class="outer">
    <section id="main_content" class="inner">

    <h3><a name="Test Engine" class="anchor" href="#test-engine"><span class="octicon octicon-link"></span></a>Test Engine</h3>

    <p>
        Internally, test engine is an adaptor to support different styles test cases, like YUI, QUnit, BDD, TDD.
    </p>
    <p>
        By default, Arrow is using YUI style testing. It can be changed by specifying '--engine', with below supported:
    </p>
    <ul>
        <li>yui (default)</li>
        <li>mocha</li>
        <li>jasmine</li>
        <li>qunit</li>
    </ul>

    <h4><a name="Using --engine in arrow cmd" class="anchor" href="#using-engine-in-arrow-cmd"><span class="octicon octicon-link"></span></a>Using --engine in arrow cmd</h4>

    Suppose you have a test case written in the popular BDD way,like:

 <pre>
 describe('Array', function(){
     describe('#push()', function(){
         it('should return the length', function(){
             var arr = [],
             assert = function(expr, msg) {
                 if (!expr) throw new Error(msg || 'failed');
             }
             assert(1 == arr.push('foo'));
             assert(2 == arr.push('bar'));
             assert(3 == arr.push('baz'));
         })
     })
 })
</pre>
    Then you can use test engine mocha to run it ,for example:

<pre>
 ./node_modules/.bin/arrow mocha-bdd.js --engine=mocha
</pre>

    And if you want to run it in client side ,just simply run :

<pre>
 ./node_modules/.bin/arrow mocha-bdd.js --engine=moch --browser=chrome

 ./node_modules/.bin/arrow mocha-bdd.js --engine=mocha --browser=phantomjs --page=http://serach.yahoo.com
</pre>

    Suppose you have a test case written in tdd way and you want to use chai as assertion :

<pre>

 suite('Array', function(){
     suite('#indexOf()', function(){
         test('should return -1 when not present', function(){
             var chai;
             if(typeof window  == "undefined" && typeof chai  == "undefined"){
                chai = require('chai');
             }
             else{
                chai = window.chai;
             }
             chai.assert(-1 == [1,2,3].indexOf(4));
         });
     });
 });
</pre>
    then you can still want mocha run it but using different "interface" in mocha like this:

<pre>
./node_modules/.bin/arrow mocha-tdd.js --engine=mocha  --engineConfig=./config.json
</pre>
    or in browser side:
<pre>
 ./node_modules/.bin/arrow mocha-tdd.js --engine=mocha  --engineConfig=./config.json  --browser=chrome
</pre>
    you can define any configuration recognized by mocha like "ui","reporter" etc. in config.json:

<pre>
 {"ui":"tdd","require":"chai"}
</pre>

    It will be passed to test engine and take effect in test execution.

    <strong>
        NOTE: This example shows that we just need to add chai to "require" field in engine config to support chai as mocha's offical assertion set.
    </strong>
    Also npm package or http links are supported in engine config.
 <pre>
 {"ui":"tdd","require":["chai","should","http://chaijs.com/chai.js"]}
 </pre>




    <h4><a name="Using engine in arrow's test descriptor" class="anchor" href="#using-engine-in-arrow-test-descriptor"><span class="octicon octicon-link"></span></a>Using engine in arrow's test descriptor</h4>

    If you have multiple style test cases and want to test it in one test descriptor ,you just need to specify which engine to use in descriptor:

<pre>

 {
     "settings":[ "master" ],
     "name":"hybrid engine server side",
     "dataprovider":{
         "mocha":{
             "params":{
                 "test":"mocha-bdd.js",
                 "engine":"mocha"
             },
             "group":"unit"
         },
         "mocha-tdd":{
             "params":{
                 "test":"mocha-tdd.js",
                 "engine":"mocha",
                 "engineConfig":"./mocha-config.json"
             },
            "group":"unit"
         },
         "jasmine":{
             "params":{
                 "test":"jasmine-bdd-test.js",
                 "engine":"jasmine"
             },
             "group":"unit"
         },
         "qunit":{
             "params":{
                "test":"qunit-test.js",
                "engine":"qunit"
             },
             "group":"unit"
         },
         "yui":{
             "params":{
                 "test":"yui-test-unit.js",
                 "lib":"./yui-lib.js"
             },
             "group":"unit"
         }
     }
 }
</pre>
    <p>
        Here qunit-test.js and jasmine-bdd-test.js are test cases can be run within qunit and jasmine. By default arrow will use yui to run tests,so in test "yui" ,
        we didn't need to specify the engine for test yui-test-unit.js.
    </p>
    Test engine can also work in scenario node:

<pre>

 {
     "settings": [ "master" ],
     "name": "YahooLogin",
     "config": {
        "baseUrl": "http://login.yahoo.com"
     },
     "commonlib" : "./mocha-lib.js",
     "dataprovider" : {
         "Use Locator to Login" : {
             "group" : "func",
             "browser":"chrome",
             "params" :{
                 "scenario": [
                 {
                     "page": "$$config.baseUrl$$"
                 },
                 {
                     "controller": "locator",
                     "params": {
                            "value": "#username",
                            "text": "arrowtestuser1"
                         }
                 },
                 {
                     "controller": "locator",
                     "params": {
                            "value": "#passwd",
                            "text": "123456"
                         }
                 },
                 {
                     "controller": "locator",
                     "params": {
                            "value": "#submit",
                            "click": true
                         }
                 },
                 {
                     "page": "http://search.yahoo.com/"
                 },
                 {
                     "test": "mocha-test.js",
                     "engine":"mocha"
                 }
                ]
             }
         }
     }
 }
</pre>
    In this test, arrow will use the locator controller to find elements in login page and after that it will go to search page to run a mocha-style test.
    Users can add any kind of test cases only if the related test engine is suppported and specified with "engine" field.
        <!-- FOOTER  -->
        <div id="footer_wrap" class="outer">
            <footer class="inner">
                <p class="copyright">Arrow maintained by <a href="https://github.com/yahoo">Yahoo</a></p>
                <p>Published with <a href="http://pages.github.com">GitHub Pages</a></p>
            </footer>
        </div>
</body>
</html>